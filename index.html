<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- íšŒì‚¬ ì •ë³´ ì¶”ê°€ -->
    <meta name="author" content="OKSTAR KOREA COMPANY">
    <meta name="copyright" content="Â© 2024 OKSTAR KOREA COMPANY. All Rights Reserved.">
    <meta name="description" content="Professional T-Shirt Design Solution by OKSTAR KOREA">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXXXXXXXXX'); // ì—¬ê¸°ì— ì‹¤ì œ ì¸¡ì • ID ì…ë ¥
    </script>
    
    <title>ì˜¥ìŠ¤íƒ€ í”„ë¦°íŒ… í”„ë¡œê·¸ë¨ - T-Print Studio v3.0 | OKSTAR KOREA COMPANY</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #1f2937;
            font-size: 32px;
            margin-bottom: 10px;
        }

        .version-badge {
            display: inline-block;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }

        .subtitle {
            color: #6b7280;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .company-badge {
            display: inline-block;
            background: #4F46E5;
            color: white;
            padding: 6px 16px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-top: 10px;
        }

        .feature-badges {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .badge {
            background: #ecfdf5;
            color: #059669;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            border: 1px solid #86efac;
        }

        .instructions {
            background: #fef3c7;
            border: 1px solid #fbbf24;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #92400e;
        }

        .upload-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .upload-section {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title.front {
            color: #3b82f6;
        }

        .section-title.back {
            color: #8b5cf6;
        }

        .upload-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .upload-box input[type="file"] {
            display: none;
        }

        .upload-label {
            display: block;
            padding: 30px 15px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            color: #475569;
            background: white;
        }

        .upload-label:hover {
            border-color: #6366f1;
            background: #f0f9ff;
        }

        .upload-label.uploaded {
            border-color: #10b981;
            background: #ecfdf5;
            color: #059669;
        }

        .file-list {
            max-height: 120px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 8px;
            background: white;
            margin-top: 10px;
            font-size: 12px;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px;
            margin: 2px 0;
            background: #f8fafc;
            border-radius: 4px;
        }

        .view-toggle {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .toggle-btn {
            padding: 10px 30px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .toggle-btn.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }

        .toggle-btn.front.active {
            background: #3b82f6;
            border-color: #3b82f6;
        }

        .toggle-btn.back.active {
            background: #8b5cf6;
            border-color: #8b5cf6;
        }

        .canvas-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .canvas-section {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
        }

        .canvas-section.hidden {
            display: none;
        }

        .canvas-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        canvas {
            border: 1px solid #e2e8f0;
            border-radius: 5px;
            background: white;
            width: 100%;
            height: auto;
            cursor: move;
        }

        .controls {
            margin-top: 15px;
        }

        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .control-label {
            font-size: 13px;
            color: #475569;
            min-width: 60px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
            background: #e2e8f0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #6366f1;
            cursor: pointer;
        }

        .scale-value {
            min-width: 45px;
            text-align: right;
            font-weight: bold;
            color: #1f2937;
            font-size: 13px;
        }

        .tab-navigation {
            display: flex;
            gap: 5px;
            overflow-x: auto;
            padding: 10px;
            background: #f1f5f9;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 6px 12px;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
            transition: all 0.2s;
        }

        .tab-button:hover {
            background: #f0f9ff;
            border-color: #6366f1;
        }

        .tab-button.active {
            background: #6366f1;
            color: white;
            border-color: #6366f1;
        }

        .progress-container {
            margin: 20px 0;
            padding: 20px;
            background: #f0f9ff;
            border-radius: 10px;
            border: 2px solid #3b82f6;
            display: none;
        }

        .progress-text {
            font-size: 16px;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 10px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #dbeafe;
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #6366f1);
            border-radius: 15px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .save-button {
            width: 100%;
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #10b981, #059669);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .save-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }

        .save-button:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        .save-button.success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 12px;
            border-top: 1px solid #eee;
            margin-top: 30px;
            background: #f9fafb;
            border-radius: 10px;
        }

        .footer-company {
            font-size: 14px;
            font-weight: bold;
            color: #4F46E5;
            margin-bottom: 5px;
        }

        @media (max-width: 1200px) {
            .canvas-container {
                grid-template-columns: 1fr;
            }
            
            .upload-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .upload-row {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                ğŸ¨ ì˜¥ìŠ¤íƒ€ í”„ë¦°íŒ… í”„ë¡œê·¸ë¨
                <span class="version-badge">v3.0</span>
            </h1>
            <p class="subtitle">Professional T-Shirt Design Solution</p>
            <div class="company-badge">OKSTAR KOREA COMPANY</div>
            <div class="feature-badges">
                <span class="badge">ğŸ‘” ì•íŒ ì‘ì—…</span>
                <span class="badge">ğŸ¨ ë’·íŒ ì‘ì—…</span>
                <span class="badge">ğŸ“¦ ì•ë’¤ ì„¸íŠ¸ ì €ì¥</span>
                <span class="badge">âœ¨ ìœ„ì¹˜ ë…ë¦½ ì„¤ì •</span>
            </div>
        </div>
        
        <div class="instructions">
            ğŸ’¡ <strong>ì‚¬ìš©ë²•:</strong> 
            1ï¸âƒ£ ì•íŒ/ë’·íŒ ë¬´ì§€ í‹°ì…”ì¸  ê°ê° ì—…ë¡œë“œ (ê°™ì€ ìƒ‰ìƒë¼ë¦¬)
            2ï¸âƒ£ ì•íŒ ë””ìì¸ ë°°ì¹˜ (ì‘ê²Œ, ê°€ìŠ´ ìœ„ì¹˜)
            3ï¸âƒ£ ë’·íŒ ë””ìì¸ ë°°ì¹˜ (í¬ê²Œ, ë“± ìœ„ì¹˜)
            4ï¸âƒ£ ì €ì¥ â†’ ì•ë’¤ ì„¸íŠ¸ë¡œ ìë™ ì €ì¥!
        </div>

        <div class="upload-grid">
            <!-- ì•íŒ ì—…ë¡œë“œ ì„¹ì…˜ -->
            <div class="upload-section">
                <div class="section-title front">
                    ğŸ‘” ì•íŒ (Front)
                </div>
                <div class="upload-row">
                    <div>
                        <input type="file" id="frontTshirtInput" accept="image/*" multiple>
                        <label for="frontTshirtInput" class="upload-label" id="frontTshirtLabel">
                            ğŸ“ ì•íŒ ë¬´ì§€í‹°<br>
                            <small>ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥</small>
                        </label>
                        <div class="file-list" id="frontTshirtList"></div>
                    </div>
                    <div>
                        <input type="file" id="frontDesignInput" accept="image/*">
                        <label for="frontDesignInput" class="upload-label" id="frontDesignLabel">
                            ğŸ¨ ì•íŒ ë””ìì¸<br>
                            <small>ê°€ìŠ´ ë¡œê³ ìš©</small>
                        </label>
                    </div>
                </div>
            </div>

            <!-- ë’·íŒ ì—…ë¡œë“œ ì„¹ì…˜ -->
            <div class="upload-section">
                <div class="section-title back">
                    ğŸ¨ ë’·íŒ (Back)
                </div>
                <div class="upload-row">
                    <div>
                        <input type="file" id="backTshirtInput" accept="image/*" multiple>
                        <label for="backTshirtInput" class="upload-label" id="backTshirtLabel">
                            ğŸ“ ë’·íŒ ë¬´ì§€í‹°<br>
                            <small>ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥</small>
                        </label>
                        <div class="file-list" id="backTshirtList"></div>
                    </div>
                    <div>
                        <input type="file" id="backDesignInput" accept="image/*">
                        <label for="backDesignInput" class="upload-label" id="backDesignLabel">
                            ğŸ¨ ë’·íŒ ë””ìì¸<br>
                            <small>ë“± ì „ì²´ìš©</small>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- í‹°ì…”ì¸  ìƒ‰ìƒ íƒ­ -->
        <div class="tab-navigation" id="tabNav">
            <span style="color: #94a3b8; padding: 6px;">í‹°ì…”ì¸ ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìƒ‰ìƒë³„ íƒ­ì´ í‘œì‹œë©ë‹ˆë‹¤</span>
        </div>

        <!-- ë·° ì „í™˜ ë²„íŠ¼ -->
        <div class="view-toggle">
            <button class="toggle-btn front active" id="viewFront">ğŸ‘” ì•íŒ ë³´ê¸°</button>
            <button class="toggle-btn back" id="viewBack">ğŸ¨ ë’·íŒ ë³´ê¸°</button>
            <button class="toggle-btn" id="viewBoth">ğŸ‘€ ë™ì‹œ ë³´ê¸°</button>
        </div>

        <!-- ìº”ë²„ìŠ¤ ì˜ì—­ -->
        <div class="canvas-container" id="canvasContainer">
            <!-- ì•íŒ ìº”ë²„ìŠ¤ -->
            <div class="canvas-section" id="frontSection">
                <div class="canvas-title" style="color: #3b82f6;">ğŸ‘” ì•íŒ ë¯¸ë¦¬ë³´ê¸°</div>
                <canvas id="frontCanvas"></canvas>
                <div class="controls">
                    <div class="control-group">
                        <span class="control-label">í¬ê¸°:</span>
                        <input type="range" id="frontScaleSlider" min="5" max="200" value="30">
                        <span class="scale-value" id="frontScaleValue">30%</span>
                    </div>
                </div>
            </div>

            <!-- ë’·íŒ ìº”ë²„ìŠ¤ -->
            <div class="canvas-section hidden" id="backSection">
                <div class="canvas-title" style="color: #8b5cf6;">ğŸ¨ ë’·íŒ ë¯¸ë¦¬ë³´ê¸°</div>
                <canvas id="backCanvas"></canvas>
                <div class="controls">
                    <div class="control-group">
                        <span class="control-label">í¬ê¸°:</span>
                        <input type="range" id="backScaleSlider" min="5" max="200" value="100">
                        <span class="scale-value" id="backScaleValue">100%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì§„í–‰ë¥  í‘œì‹œ -->
        <div class="progress-container" id="progressBar">
            <div class="progress-text">ì²˜ë¦¬ ì¤‘...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
        </div>

        <!-- ì €ì¥ ë²„íŠ¼ -->
        <button id="saveBtn" class="save-button" disabled>
            <span>ğŸ“¦</span>
            <span id="saveBtnText">ì•íŒê³¼ ë’·íŒ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•˜ì„¸ìš”</span>
        </button>

        <!-- ì €ì‘ê¶Œ í‘œì‹œ -->
        <div class="footer">
            <div class="footer-company">OKSTAR KOREA COMPANY</div>
            Â© 2024 All Rights Reserved. Unauthorized use is strictly prohibited.<br>
            ë³¸ í”„ë¡œê·¸ë¨ì€ OKSTAR KOREA COMPANYì˜ ì§€ì  ì¬ì‚°ì…ë‹ˆë‹¤.<br>
            Contact: info@okstar.kr | Support: support@okstar.kr
        </div>
    </div>

    <!-- JSZip ë¼ì´ë¸ŒëŸ¬ë¦¬ (ZIP ë‹¤ìš´ë¡œë“œìš©) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <script>
        // ì½˜ì†” ì €ì‘ê¶Œ í‘œì‹œ
        console.log('%cğŸ¨ ì˜¥ìŠ¤íƒ€ í”„ë¦°íŒ… í”„ë¡œê·¸ë¨ v3.0', 'font-size: 20px; font-weight: bold; color: #4F46E5;');
        console.log('%cÂ© 2024 OKSTAR KOREA COMPANY', 'font-size: 12px; color: #666;');
        console.log('%câš ï¸ ì´ í”„ë¡œê·¸ë¨ì˜ ë¬´ë‹¨ ë³µì œ ë° ìˆ˜ì •ì€ ë²•ì  ì œì¬ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'color: red; font-weight: bold;');
        console.log('%cUnauthorized copying, modification, or distribution is strictly prohibited.', 'color: #ff6b6b; font-style: italic;');

        // Google Analytics ì´ë²¤íŠ¸ ì¶”ì  í•¨ìˆ˜
        function trackEvent(eventName, parameters) {
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, parameters);
            }
        }

        // T-Print Studio v3.0 - ì•ë’¤ ë™ì‹œ ì‘ì—… ì‹œìŠ¤í…œ
        // Copyright (C) 2024 OKSTAR KOREA COMPANY. All Rights Reserved.
        
        class FrontBackDesigner {
            constructor() {
                // ìº”ë²„ìŠ¤ ì„¤ì •
                this.frontCanvas = document.getElementById('frontCanvas');
                this.backCanvas = document.getElementById('backCanvas');
                this.frontCtx = this.frontCanvas.getContext('2d');
                this.backCtx = this.backCanvas.getContext('2d');
                
                // ìº”ë²„ìŠ¤ í¬ê¸°
                this.frontCanvas.width = 600;
                this.frontCanvas.height = 720;
                this.backCanvas.width = 600;
                this.backCanvas.height = 720;
                
                // ë°ì´í„° ê´€ë¦¬
                this.data = {
                    front: {
                        tshirts: [],
                        design: null,
                        position: { x: 300, y: 200 },  // ê°€ìŠ´ ìœ„ì¹˜ (ìƒë‹¨)
                        scale: 0.3,  // ì‘ê²Œ
                        currentIndex: 0
                    },
                    back: {
                        tshirts: [],
                        design: null,
                        position: { x: 300, y: 360 },  // ë“± ì¤‘ì•™ (ì¤‘ê°„)
                        scale: 1.0,  // í¬ê²Œ
                        currentIndex: 0
                    }
                };
                
                // ë·° ìƒíƒœ
                this.viewMode = 'front';  // 'front', 'back', 'both'
                
                // ë“œë˜ê·¸ ìƒíƒœ
                this.isDragging = false;
                this.dragTarget = null;  // 'front' or 'back'
                this.dragStart = { x: 0, y: 0 };
                
                // UI ìš”ì†Œ
                this.initUIElements();
                this.initEvents();
                this.render();

                // í”„ë¡œê·¸ë¨ ì‹œì‘ ì¶”ì 
                trackEvent('app_start', {
                    version: '3.0',
                    company: 'OKSTAR KOREA'
                });
            }
            
            initUIElements() {
                // ì—…ë¡œë“œ ì¸í’‹
                this.frontTshirtInput = document.getElementById('frontTshirtInput');
                this.backTshirtInput = document.getElementById('backTshirtInput');
                this.frontDesignInput = document.getElementById('frontDesignInput');
                this.backDesignInput = document.getElementById('backDesignInput');
                
                // ë¼ë²¨
                this.frontTshirtLabel = document.getElementById('frontTshirtLabel');
                this.backTshirtLabel = document.getElementById('backTshirtLabel');
                this.frontDesignLabel = document.getElementById('frontDesignLabel');
                this.backDesignLabel = document.getElementById('backDesignLabel');
                
                // íŒŒì¼ ë¦¬ìŠ¤íŠ¸
                this.frontTshirtList = document.getElementById('frontTshirtList');
                this.backTshirtList = document.getElementById('backTshirtList');
                
                // ìŠ¬ë¼ì´ë”
                this.frontScaleSlider = document.getElementById('frontScaleSlider');
                this.backScaleSlider = document.getElementById('backScaleSlider');
                this.frontScaleValue = document.getElementById('frontScaleValue');
                this.backScaleValue = document.getElementById('backScaleValue');
                
                // ë·° í† ê¸€
                this.viewFrontBtn = document.getElementById('viewFront');
                this.viewBackBtn = document.getElementById('viewBack');
                this.viewBothBtn = document.getElementById('viewBoth');
                
                // ê¸°íƒ€
                this.tabNav = document.getElementById('tabNav');
                this.saveBtn = document.getElementById('saveBtn');
                this.saveBtnText = document.getElementById('saveBtnText');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                
                // ì„¹ì…˜
                this.frontSection = document.getElementById('frontSection');
                this.backSection = document.getElementById('backSection');
                this.canvasContainer = document.getElementById('canvasContainer');
            }
            
            initEvents() {
                // íŒŒì¼ ì—…ë¡œë“œ
                this.frontTshirtInput.addEventListener('change', (e) => {
                    this.loadTshirts(e, 'front');
                    trackEvent('file_upload', { type: 'tshirt', side: 'front' });
                });
                this.backTshirtInput.addEventListener('change', (e) => {
                    this.loadTshirts(e, 'back');
                    trackEvent('file_upload', { type: 'tshirt', side: 'back' });
                });
                this.frontDesignInput.addEventListener('change', (e) => {
                    this.loadDesign(e, 'front');
                    trackEvent('file_upload', { type: 'design', side: 'front' });
                });
                this.backDesignInput.addEventListener('change', (e) => {
                    this.loadDesign(e, 'back');
                    trackEvent('file_upload', { type: 'design', side: 'back' });
                });
                
                // ë·° ì „í™˜
                this.viewFrontBtn.addEventListener('click', () => {
                    this.setViewMode('front');
                    trackEvent('view_change', { mode: 'front' });
                });
                this.viewBackBtn.addEventListener('click', () => {
                    this.setViewMode('back');
                    trackEvent('view_change', { mode: 'back' });
                });
                this.viewBothBtn.addEventListener('click', () => {
                    this.setViewMode('both');
                    trackEvent('view_change', { mode: 'both' });
                });
                
                // ìº”ë²„ìŠ¤ ë“œë˜ê·¸ - ì•íŒ
                this.frontCanvas.addEventListener('mousedown', (e) => this.startDrag(e, 'front'));
                this.frontCanvas.addEventListener('mousemove', (e) => this.drag(e, 'front'));
                this.frontCanvas.addEventListener('mouseup', () => this.endDrag());
                this.frontCanvas.addEventListener('mouseleave', () => this.endDrag());
                
                // ìº”ë²„ìŠ¤ ë“œë˜ê·¸ - ë’·íŒ
                this.backCanvas.addEventListener('mousedown', (e) => this.startDrag(e, 'back'));
                this.backCanvas.addEventListener('mousemove', (e) => this.drag(e, 'back'));
                this.backCanvas.addEventListener('mouseup', () => this.endDrag());
                this.backCanvas.addEventListener('mouseleave', () => this.endDrag());
                
                // ìŠ¬ë¼ì´ë”
                this.frontScaleSlider.addEventListener('input', (e) => this.updateScale(e, 'front'));
                this.backScaleSlider.addEventListener('input', (e) => this.updateScale(e, 'back'));
                
                // ì €ì¥
                this.saveBtn.addEventListener('click', () => {
                    this.saveAll();
                    trackEvent('save_images', {
                        count: Math.min(this.data.front.tshirts.length, this.data.back.tshirts.length)
                    });
                });
                
                // í‚¤ë³´ë“œ
                document.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 's') {
                        e.preventDefault();
                        if (!this.saveBtn.disabled) {
                            this.saveAll();
                        }
                    }
                });
            }
            
            setViewMode(mode) {
                this.viewMode = mode;
                
                // ë²„íŠ¼ ìƒíƒœ
                this.viewFrontBtn.classList.remove('active');
                this.viewBackBtn.classList.remove('active');
                this.viewBothBtn.classList.remove('active');
                
                // ìº”ë²„ìŠ¤ í‘œì‹œ
                if (mode === 'front') {
                    this.viewFrontBtn.classList.add('active');
                    this.frontSection.classList.remove('hidden');
                    this.backSection.classList.add('hidden');
                    this.canvasContainer.style.gridTemplateColumns = '1fr';
                } else if (mode === 'back') {
                    this.viewBackBtn.classList.add('active');
                    this.frontSection.classList.add('hidden');
                    this.backSection.classList.remove('hidden');
                    this.canvasContainer.style.gridTemplateColumns = '1fr';
                } else if (mode === 'both') {
                    this.viewBothBtn.classList.add('active');
                    this.frontSection.classList.remove('hidden');
                    this.backSection.classList.remove('hidden');
                    this.canvasContainer.style.gridTemplateColumns = '1fr 1fr';
                }
            }
            
            loadTshirts(e, side) {
                const files = Array.from(e.target.files);
                const validFiles = files.filter(f => f.type.startsWith('image/')).slice(0, 20);
                
                this.data[side].tshirts = [];
                this.data[side].currentIndex = 0;
                
                let loadedCount = 0;
                
                validFiles.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            this.data[side].tshirts.push({
                                name: file.name.split('.')[0],
                                image: img
                            });
                            
                            loadedCount++;
                            if (loadedCount === validFiles.length) {
                                this.updateFileList(side);
                                this.updateTabs();
                                this.checkReadyState();
                                this.render();
                            }
                        };
                        img.src = e.target.result;
                    };
                    reader.readAsDataURL(file);
                });
                
                // UI ì—…ë°ì´íŠ¸
                if (side === 'front') {
                    this.frontTshirtLabel.classList.add('uploaded');
                    this.frontTshirtLabel.innerHTML = `âœ… ì•íŒ ${validFiles.length}ê°œ<br><small>ì—…ë¡œë“œ ì™„ë£Œ</small>`;
                } else {
                    this.backTshirtLabel.classList.add('uploaded');
                    this.backTshirtLabel.innerHTML = `âœ… ë’·íŒ ${validFiles.length}ê°œ<br><small>ì—…ë¡œë“œ ì™„ë£Œ</small>`;
                }
            }
            
            loadDesign(e, side) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        this.data[side].design = img;
                        
                        // UI ì—…ë°ì´íŠ¸
                        if (side === 'front') {
                            this.frontDesignLabel.classList.add('uploaded');
                            this.frontDesignLabel.innerHTML = `âœ… ì•íŒ ë””ìì¸<br><small>${file.name}</small>`;
                        } else {
                            this.backDesignLabel.classList.add('uploaded');
                            this.backDesignLabel.innerHTML = `âœ… ë’·íŒ ë””ìì¸<br><small>${file.name}</small>`;
                        }
                        
                        this.checkReadyState();
                        this.render();
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
            
            updateFileList(side) {
                const listEl = side === 'front' ? this.frontTshirtList : this.backTshirtList;
                const tshirts = this.data[side].tshirts;
                
                listEl.innerHTML = '';
                
                if (tshirts.length === 0) {
                    listEl.innerHTML = '<span style="color: #94a3b8;">íŒŒì¼ ì—†ìŒ</span>';
                    return;
                }
                
                tshirts.forEach((tshirt, index) => {
                    const item = document.createElement('div');
                    item.className = 'file-item';
                    item.textContent = tshirt.name;
                    listEl.appendChild(item);
                });
            }
            
            updateTabs() {
                const frontCount = this.data.front.tshirts.length;
                const backCount = this.data.back.tshirts.length;
                
                if (frontCount === 0 && backCount === 0) {
                    this.tabNav.innerHTML = '<span style="color: #94a3b8; padding: 6px;">í‹°ì…”ì¸ ë¥¼ ì—…ë¡œë“œí•˜ë©´ ìƒ‰ìƒë³„ íƒ­ì´ í‘œì‹œë©ë‹ˆë‹¤</span>';
                    return;
                }
                
                this.tabNav.innerHTML = '';
                
                // ì•ë’¤ ë§¤ì¹­ëœ ìƒ‰ìƒë§Œ í‘œì‹œ
                const maxCount = Math.min(frontCount, backCount);
                
                for (let i = 0; i < maxCount; i++) {
                    const frontName = this.data.front.tshirts[i]?.name || '';
                    const backName = this.data.back.tshirts[i]?.name || '';
                    
                    const button = document.createElement('button');
                    button.className = 'tab-button';
                    button.textContent = frontName || backName || `ìƒ‰ìƒ ${i + 1}`;
                    
                    if (i === this.data.front.currentIndex) {
                        button.classList.add('active');
                    }
                    
                    button.addEventListener('click', () => {
                        this.switchTshirt(i);
                    });
                    
                    this.tabNav.appendChild(button);
                }
            }
            
            switchTshirt(index) {
                this.data.front.currentIndex = index;
                this.data.back.currentIndex = index;
                this.updateTabs();
                this.render();
            }
            
            startDrag(e, side) {
                if (!this.data[side].design) return;
                
                const rect = e.target.getBoundingClientRect();
                const canvas = side === 'front' ? this.frontCanvas : this.backCanvas;
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                
                if (this.isInsideDesign(x, y, side)) {
                    this.isDragging = true;
                    this.dragTarget = side;
                    this.dragStart = { x, y };
                    e.target.style.cursor = 'grabbing';
                }
            }
            
            drag(e, side) {
                if (!this.isDragging || this.dragTarget !== side) return;
                
                const rect = e.target.getBoundingClientRect();
                const canvas = side === 'front' ? this.frontCanvas : this.backCanvas;
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                
                const x = (e.clientX - rect.left) * scaleX;
                const y = (e.clientY - rect.top) * scaleY;
                
                const dx = x - this.dragStart.x;
                const dy = y - this.dragStart.y;
                
                this.data[side].position.x += dx;
                this.data[side].position.y += dy;
                
                this.dragStart = { x, y };
                this.render();
            }
            
            endDrag() {
                this.isDragging = false;
                this.dragTarget = null;
                this.frontCanvas.style.cursor = 'move';
                this.backCanvas.style.cursor = 'move';
            }
            
            isInsideDesign(x, y, side) {
                const data = this.data[side];
                if (!data.design) return false;
                
                const width = data.design.width * data.scale * 0.5;
                const height = data.design.height * data.scale * 0.5;
                const pos = data.position;
                
                return x >= pos.x - width/2 && x <= pos.x + width/2 &&
                       y >= pos.y - height/2 && y <= pos.y + height/2;
            }
            
            updateScale(e, side) {
                this.data[side].scale = e.target.value / 100;
                
                if (side === 'front') {
                    this.frontScaleValue.textContent = e.target.value + '%';
                } else {
                    this.backScaleValue.textContent = e.target.value + '%';
                }
                
                this.render();
            }
            
            render() {
                // ì•íŒ ë Œë”ë§
                this.renderSide('front', this.frontCanvas, this.frontCtx);
                
                // ë’·íŒ ë Œë”ë§
                this.renderSide('back', this.backCanvas, this.backCtx);
            }
            
            renderSide(side, canvas, ctx) {
                const data = this.data[side];
                
                // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // í’ˆì§ˆ ì„¤ì •
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                // ë°°ê²½
                ctx.fillStyle = '#f8fafc';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // í‹°ì…”ì¸ 
                const tshirt = data.tshirts[data.currentIndex];
                if (tshirt && tshirt.image) {
                    const scale = Math.min(
                        canvas.width / tshirt.image.width,
                        canvas.height / tshirt.image.height
                    ) * 0.9;
                    
                    const width = tshirt.image.width * scale;
                    const height = tshirt.image.height * scale;
                    const x = (canvas.width - width) / 2;
                    const y = (canvas.height - height) / 2;
                    
                    ctx.drawImage(tshirt.image, x, y, width, height);
                }
                
                // ë””ìì¸
                if (data.design) {
                    const width = data.design.width * data.scale * 0.5;
                    const height = data.design.height * data.scale * 0.5;
                    const x = data.position.x - width / 2;
                    const y = data.position.y - height / 2;
                    
                    // ì•ˆí‹°ì•¨ë¦¬ì–´ì‹± ì ìš©
                    if (data.scale < 0.5) {
                        const scaledCanvas = this.highQualityDownscale(
                            data.design, width, height
                        );
                        ctx.drawImage(scaledCanvas, x, y);
                    } else {
                        ctx.drawImage(data.design, x, y, width, height);
                    }
                    
                    // í…Œë‘ë¦¬
                    ctx.strokeStyle = side === 'front' ? 
                        'rgba(59, 130, 246, 0.3)' : 'rgba(139, 92, 246, 0.3)';
                    ctx.lineWidth = 2;
                    ctx.setLineDash([5, 5]);
                    ctx.strokeRect(x, y, width, height);
                    ctx.setLineDash([]);
                }

                // OKSTAR ì›Œí„°ë§ˆí¬ (ìš°í•˜ë‹¨)
                ctx.fillStyle = 'rgba(79, 70, 229, 0.15)';
                ctx.font = 'bold 10px Arial';
                ctx.fillText('OKSTAR', canvas.width - 50, canvas.height - 10);
            }
            
            highQualityDownscale(img, targetWidth, targetHeight) {
                let currentWidth = img.width;
                let currentHeight = img.height;
                let currentImage = img;
                
                while (currentWidth > targetWidth * 2 || currentHeight > targetHeight * 2) {
                    const tempCanvas = document.createElement('canvas');
                    const tempCtx = tempCanvas.getContext('2d');
                    
                    currentWidth = Math.max(currentWidth * 0.5, targetWidth);
                    currentHeight = Math.max(currentHeight * 0.5, targetHeight);
                    
                    tempCanvas.width = currentWidth;
                    tempCanvas.height = currentHeight;
                    
                    tempCtx.imageSmoothingEnabled = true;
                    tempCtx.imageSmoothingQuality = 'high';
                    tempCtx.drawImage(currentImage, 0, 0, currentWidth, currentHeight);
                    
                    currentImage = tempCanvas;
                }
                
                const finalCanvas = document.createElement('canvas');
                const finalCtx = finalCanvas.getContext('2d');
                
                finalCanvas.width = targetWidth;
                finalCanvas.height = targetHeight;
                
                finalCtx.imageSmoothingEnabled = true;
                finalCtx.imageSmoothingQuality = 'high';
                finalCtx.drawImage(currentImage, 0, 0, targetWidth, targetHeight);
                
                return finalCanvas;
            }
            
            checkReadyState() {
                const hasFrontTshirts = this.data.front.tshirts.length > 0;
                const hasBackTshirts = this.data.back.tshirts.length > 0;
                const hasFrontDesign = this.data.front.design !== null;
                const hasBackDesign = this.data.back.design !== null;
                
                if (hasFrontTshirts && hasBackTshirts && hasFrontDesign && hasBackDesign) {
                    this.saveBtn.disabled = false;
                    const count = Math.min(
                        this.data.front.tshirts.length,
                        this.data.back.tshirts.length
                    );
                    this.saveBtnText.textContent = `ğŸ“¦ ${count}ê°œ ìƒ‰ìƒ ì•ë’¤ ì„¸íŠ¸ ì €ì¥`;
                } else {
                    this.saveBtn.disabled = true;
                    this.saveBtnText.textContent = 'ì•íŒê³¼ ë’·íŒ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•˜ì„¸ìš”';
                }
            }
            
            async saveAll() {
                const startTime = Date.now();
                const count = Math.min(
                    this.data.front.tshirts.length,
                    this.data.back.tshirts.length
                );
                
                const files = [];
                
                // ì§„í–‰ë¥  í‘œì‹œ
                this.showProgress(0, count * 2);
                
                for (let i = 0; i < count; i++) {
                    // ì•íŒ ì €ì¥
                    const frontCanvas = this.createCanvas(i, 'front');
                    const frontBlob = await this.canvasToBlob(frontCanvas);
                    const frontName = `${this.data.front.tshirts[i].name}_front_OKSTAR.png`;
                    files.push({ name: frontName, blob: frontBlob });
                    
                    this.showProgress(i * 2 + 1, count * 2);
                    
                    // ë’·íŒ ì €ì¥
                    const backCanvas = this.createCanvas(i, 'back');
                    const backBlob = await this.canvasToBlob(backCanvas);
                    const backName = `${this.data.back.tshirts[i].name}_back_OKSTAR.png`;
                    files.push({ name: backName, blob: backBlob });
                    
                    this.showProgress(i * 2 + 2, count * 2);
                    
                    await this.delay(50);
                }
                
                // ZIP ë‹¤ìš´ë¡œë“œ
                await this.downloadAsZip(files);
                
                const processingTime = (Date.now() - startTime) / 1000;
                trackEvent('process_complete', {
                    image_count: count * 2,
                    processing_time: processingTime
                });
                
                this.hideProgress();
                this.showSuccess(count);
            }
            
            createCanvas(index, side) {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                canvas.width = 1200;
                canvas.height = 1440;
                
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                // ë°°ê²½
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // í‹°ì…”ì¸ 
                const tshirt = this.data[side].tshirts[index];
                if (tshirt && tshirt.image) {
                    const scale = Math.min(
                        canvas.width / tshirt.image.width,
                        canvas.height / tshirt.image.height
                    ) * 0.9;
                    
                    const width = tshirt.image.width * scale;
                    const height = tshirt.image.height * scale;
                    const x = (canvas.width - width) / 2;
                    const y = (canvas.height - height) / 2;
                    
                    ctx.drawImage(tshirt.image, x, y, width, height);
                }
                
                // ë””ìì¸ (ìŠ¤ì¼€ì¼ ì¡°ì • í•„ìš”)
                if (this.data[side].design) {
                    // ìº”ë²„ìŠ¤ í¬ê¸° ë¹„ìœ¨ ê³„ì‚°
                    const scaleRatio = canvas.width / 600;  // 600ì€ ë¯¸ë¦¬ë³´ê¸° ìº”ë²„ìŠ¤ í¬ê¸°
                    
                    const width = this.data[side].design.width * this.data[side].scale * scaleRatio * 0.5;
                    const height = this.data[side].design.height * this.data[side].scale * scaleRatio * 0.5;
                    const x = (this.data[side].position.x * scaleRatio) - width / 2;
                    const y = (this.data[side].position.y * scaleRatio) - height / 2;
                    
                    if (this.data[side].scale < 0.5) {
                        const scaledCanvas = this.highQualityDownscale(
                            this.data[side].design, width, height
                        );
                        ctx.drawImage(scaledCanvas, x, y);
                    } else {
                        ctx.drawImage(this.data[side].design, x, y, width, height);
                    }
                }
                
                // OKSTAR ì›Œí„°ë§ˆí¬ ì¶”ê°€ (ìš°í•˜ë‹¨)
                ctx.fillStyle = 'rgba(79, 70, 229, 0.2)';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('Â© OKSTAR KOREA', canvas.width - 120, canvas.height - 20);
                
                return canvas;
            }
            
            canvasToBlob(canvas) {
                return new Promise(resolve => {
                    canvas.toBlob(blob => {
                        resolve(blob);
                    }, 'image/png', 1.0);
                });
            }
            
            async downloadAsZip(files) {
                const zip = new JSZip();
                const folder = zip.folder('OKSTAR_Printing_Output');
                
                // ì €ì‘ê¶Œ ì •ë³´ íŒŒì¼ ì¶”ê°€
                const copyrightInfo = `
OKSTAR PRINTING PROGRAM v3.0
Copyright Â© 2024 OKSTAR KOREA COMPANY
All Rights Reserved.

ì´ íŒŒì¼ë“¤ì€ OKSTAR í”„ë¦°íŒ… í”„ë¡œê·¸ë¨ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
ë¬´ë‹¨ ë°°í¬ ë° ìƒì—…ì  ì‚¬ìš©ì„ ê¸ˆì§€í•©ë‹ˆë‹¤.

ì œì‘ì¼ì‹œ: ${new Date().toLocaleString('ko-KR')}
ì´ íŒŒì¼ ìˆ˜: ${files.length}ê°œ

ë¬¸ì˜ì‚¬í•­:
- Email: info@okstar.kr
- Support: support@okstar.kr
- Website: www.okstar.kr

OKSTAR KOREA COMPANY
Professional Printing Solutions
                `;
                
                folder.file('COPYRIGHT_OKSTAR.txt', copyrightInfo);
                
                files.forEach(file => {
                    folder.file(file.name, file.blob);
                });
                
                const content = await zip.generateAsync({
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });
                
                const timestamp = new Date().toISOString()
                    .replace(/[:.]/g, '')
                    .slice(0, 15);
                
                const a = document.createElement('a');
                a.href = URL.createObjectURL(content);
                a.download = `OKSTAR_tshirt_${timestamp}.zip`;
                a.click();
                
                URL.revokeObjectURL(a.href);
            }
            
            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            
            showProgress(current, total) {
                const percent = Math.round((current / total) * 100);
                
                this.progressBar.style.display = 'block';
                this.progressBar.querySelector('.progress-text').textContent = 
                    `ì²˜ë¦¬ ì¤‘... (${current}/${total})`;
                this.progressFill.style.width = percent + '%';
                this.progressFill.textContent = percent + '%';
                
                this.saveBtn.disabled = true;
                this.saveBtnText.textContent = `ì²˜ë¦¬ ì¤‘... ${percent}%`;
            }
            
            hideProgress() {
                this.progressBar.style.display = 'none';
                this.saveBtn.disabled = false;
            }
            
            showSuccess(count) {
                const originalText = this.saveBtnText.textContent;
                
                this.saveBtn.classList.add('success');
                this.saveBtnText.textContent = `âœ… ${count}ê°œ ìƒ‰ìƒ ì•ë’¤ ì„¸íŠ¸ ì €ì¥ ì™„ë£Œ!`;
                
                setTimeout(() => {
                    this.saveBtn.classList.remove('success');
                    this.saveBtnText.textContent = originalText;
                    this.checkReadyState();
                }, 3000);
            }
        }
        
        // ì•± ì‹œì‘
        document.addEventListener('DOMContentLoaded', () => {
            const app = new FrontBackDesigner();
            console.log('ğŸ¨ ì˜¥ìŠ¤íƒ€ í”„ë¦°íŒ… í”„ë¡œê·¸ë¨ v3.0 ì‹œì‘');
            console.log('ğŸ“ ë¬¸ì˜: info@okstar.kr');
            console.log('ğŸ¢ OKSTAR KOREA COMPANY - Professional Printing Solutions');
        });

        // ê°„ë‹¨í•œ ë³´ì•ˆ (ìš°í´ë¦­ ë°©ì§€)
        document.addEventListener('contextmenu', e => {
            e.preventDefault();
            alert('Â© OKSTAR KOREA COMPANY\nìš°í´ë¦­ì´ ì°¨ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
            return false;
        });
    </script>
</body>
</html>